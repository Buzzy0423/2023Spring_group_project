# 基于无源自适应的医学图像增强

## CATALOGUE

1.  研究背景
2.  研究内容
3.  预期成果及规划

## 研究背景

领域自适应方法已经开始被使用在医学领域，以解决不同设备、不同场景、不同模态等因素导致的医学图像之间的分布差异问题。然而，现存的自监督领域自适应方法存在三个较为明显的问题。

-   隐私保护：源域数据集往往包含敏感的个人信息，如病历、诊断等，如果直接公开或共享给其他机构或个人可能会造成隐私泄露。
-   数据储存：源域数据集往往占用大量的存储空间，如果需要在不同的设备或平台上进行迁移学习，可能会带来数据传输和存储的困难。
-   运算负担：源域数据集往往需要不断地更新和维护，如果需要在每次迁移学习时都重新训练源模型，可能会增加计算资源和时间的消耗。

针对以上问题，无源领域自适应可以通过无源的性质来保护用户的隐私的同时减少数据的储存。

## 无源领域自适应

无源领域自适应是一种不借助源域数据，只利用从源域上训练出来并且可访问或部分可访问（如模型参数、统计信息等）的模型向目标域进行迁移学习并提升目标任务性能（如分类准确率、图像质量等）的方法。

### 无源领域自适应的分类

根据是否完全可访问预先训练好并且固定不变（即冻结）了所有参数层次结构（即网络架构）以及参数值（即权重）的模型，无源领域自适应可以分为两类：

-   白盒(White-box)：完全可访问预先训练好并且固定不变了所有参数层次结构以及参数值的模型
-   黑盒(Black-box)：不能完全可访问预先训练好并且固定不变了所有参数层次结构以及参数值的模型 

考虑到项目开发时间与难度，本项目使用white-box方法

白盒方法按照思路主要分为两大类，每个大类有可以按照不同的方法分为几个小类。

#### 第一大类--数据生成

这类方法主要通过生成与目标任务相关联或者与目标任务相似度高但又与目标任务有差异性或者与目标任务相似度低但又与目标任务有关联性或者与目标任务相似度低但又与目标任务有关联性或者与目标任务相似度高但又与目标任务有差异性的数据，从而提高模型在目标域上的泛化能力。这类方法可以分为以下几种：

1.  BN方法：BN层主要包含了图像的风格信息，如颜色、对比度、亮度等。这类方法首先通过BN层储存图像的风格和原图减去风格信息之后的内容，然后利用傅里叶变换生成一个更加精细和逼真的图像，之后将生成图像和原图做域一致性检查。
2.  代替源域数据生成：为了弥补源域数据的缺失，这类方法通过交替使用自适应和样本传输规则对源域进行学习并获得相应标签，从而实现跨域转化。
3.  GAN生成：这类方法通过GAN生成与目标域风格相近或相同但内容不同或相似的图像，之后再学习生成代理图像和原图之间不变或相似的特征。

#### 第二大类--模型微调

这类方法主要通过对预训练模型进行一定程度上的修改或调整，以适应目标域上的数据分布和任务需求。这类方法可以分为以下几种：

1.  自监督知识蒸：通过知识蒸馏，将源域中学习到的知识转移到目标模型中去。具体地，利用预训练好的源模型作为教师模型，在目标数据上给出软标签，并用一个较小或相同结构的学生模型来拟合这些软标签。这样可以有效地保留源领域知识并降低计算复杂度。
2.  通过统计数据进行域对齐：利用存储在预先训练好的源模型中的批统计来近似不可访问源数据的分布，然后通过减少源域和目标域之间的分布差异来执行跨域适应。具体地，在每个卷积层或BN层后添加一个对齐层（Align Layer），该层使用存储在源模型中相应位置处批统计来归一化目标数据，并用一个可学习参数来缩放输出特征。
3.  对抗学习：将相似类别的实例拉近，并将不同类别的实例推到特征空间中。具体地，在特征提取器后添加一个判别器（Discriminator），该判别器试图区分输入特征是来自于哪个领域，并给出一个概率值。同时，在训练过程中最小化判别器输出与真实领域标签之间交叉熵损失函数，并最大化判别器输出与反向领域标签之间交叉熵损失函数。这样可以使得特征提取器产生更加混淆判别器并增强领域不变性。
4.  不确定性引导自适应：不确定性可以衡量目标模型对于目标数据分布的拟合程度。具体地，在预测阶段给出每个样本属于各个类别的概率值，并根据概率值的大小或熵值的高低来判断样本的不确定性。然后，根据不确定性来选择一些高置信度的样本作为伪标签，并用这些伪标签来更新模型参数。这样可以有效地利用目标数据中的有用信息并减少噪声干扰。
5.  隐藏结构挖掘：考虑内在特征结构之后通过聚类算法和伪标签来更新模型。具体地，首先使用预训练好的源模型在目标数据上提取特征，并将这些特征输入一个聚类算法（如K-means）来得到若干个簇。然后，为每个簇分配一个伪标签，并用这些伪标签来训练一个新的分类器。同时，在训练过程中最小化簇内距离和最大化簇间距离，以增强特征空间中的结构信息。

## 项目预期成果及规划

项目预期成果：论文一篇

项目规划：

2023.2-2023.3调研课题

2023.3-2023.4复现已有无源自适应算法，设计模型

2023.4-2023.5模型训练与实验

2023.5-2023.6完善实验，撰写论文

